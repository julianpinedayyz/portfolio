---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

export interface Props {
  title: string;
  description?: string;
  noindex?: boolean;
}

const {
  title,
  description = "Julian Pineda's portfolio website - Technology Leader & Digital Transformation Specialist",
  noindex = false,
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta
  http-equiv="Content-Security-Policy"
  content="
    default-src 'self';
    script-src 'self' 'unsafe-inline';
    style-src  'self' 'unsafe-inline' https://fonts.googleapis.com https://rsms.me;
    font-src   'self' data: https://fonts.gstatic.com https://rsms.me;
    img-src    'self' data: https://placehold.co;
    connect-src 'self' https://adk-short-bot-gozfxot5la-uc.a.run.app;
    frame-src  'self' https://ai-rag-agent.storage.googleapis.com;
    form-action 'self' https://adk-short-bot-gozfxot5la-uc.a.run.app;
    object-src 'none';
    base-uri   'self';
  "
/>
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={description} />
    <meta name="author" content="Julian Pineda" />
    {noindex && <meta name="robots" content="noindex,nofollow" />}
    <meta name="keywords" content="digital transformation, technology leadership, UI/UX strategy, web accessibility, enterprise architecture, legacy system modernization, technical project management, strategic technology planning, team building, mentorship, agile development, product strategy, client relationship management, director of technology, Lab 829, frontend development, Julian Pineda" />
    <title>{title}</title>

    <!-- Open Graph tags for social sharing -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={`https://www.julianpineda.com${Astro.url.pathname}`} />
    <meta property="og:image" content="https://placehold.co/1200x630/1a1a1a/ffffff?text=Julian+Pineda" />
    <meta property="og:site_name" content="Julian Pineda" />

    <!-- Twitter Card tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content="https://placehold.co/1200x630/1a1a1a/ffffff?text=Julian+Pineda" />

    <!-- Canonical URL - Always pointing to primary domain -->
    <link rel="canonical" href={`https://www.julianpineda.com${Astro.url.pathname}`} />

    <!-- Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Julian Pineda",
        "url": "https://www.julianpineda.com",
        "jobTitle": "Director of Technology",
        "worksFor": {
          "@type": "Organization",
          "name": "Lab 829",
          "description": "A global digital transformation consultancy specializing in tailored development and activation strategies"
        },
        "sameAs": [
          "https://github.com/julianpinedayyz",
          "https://linkedin.com/in/julianpinedayyz"
        ],
        "knowsAbout": [
          "Digital Transformation",
          "Technology Leadership",
          "UI/UX Strategy",
          "Web Accessibility",
          "Enterprise Architecture",
          "Legacy System Modernization",
          "Technical Project Management",
          "Strategic Technology Planning",
          "Team Building & Mentorship",
          "Agile Development",
          "Product Strategy",
          "Client Relationship Management"
        ],
        "description": "With a strong track record of aligning strategic initiatives with business goals, I drive innovation and deliver meaningful impact across government, retail, consulting, fintech, and marketing sectors."
      }
    </script>

    <!-- Preconnect to required origins -->
    <link rel="preconnect" href="https://rsms.me/" crossorigin />

    <!-- Preload the Inter font CSS asynchronously -->
    <link
      rel="preload"
      href="https://rsms.me/inter/inter.css"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript
      ><link
        rel="stylesheet"
        href="https://rsms.me/inter/inter.css"
      /></noscript
    >

    <!-- Optimized Google Fonts loading (non-blocking) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript>
      <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
      />
    </noscript>
  </head>
  <body class="text-gray-900 bg-white font-sans antialiased">
    <a href="#main-content" class="skip-to-content focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-[#0E0E2C]">Skip to content</a>
    <Header />
    <main id="main-content">
      <slot />
    </main>
    <Footer />

    {/* Window size indicator (for development only) */}
    {import.meta.env.DEV && (
      <>
        <div
          id="size-indicator"
          class="fixed bottom-4 left-4 bg-black/70 text-white px-3 py-1.5 rounded-md text-xs z-50 font-mono"
        >
          Size: <span id="width">-</span> x <span id="height">-</span>
        </div>

        <script is:inline>
          // Update the size indicator on load and resize
          function updateSizeIndicator() {
            const widthEl = document.getElementById('width');
            const heightEl = document.getElementById('height');
            if (widthEl && heightEl) {
              widthEl.textContent = window.innerWidth;
              heightEl.textContent = window.innerHeight;
            }
          }

          // Initialize size indicator
          window.addEventListener('DOMContentLoaded', updateSizeIndicator);
          window.addEventListener('resize', updateSizeIndicator);

          // Initial call in case DOMContentLoaded already fired
          updateSizeIndicator();
        </script>
      </>
    )}
  </body>
</html>

<style is:global>
  /* Set base styles for the site */
  :root {
    --color-text: #111827;
    --color-bg: #ffffff;
    --color-primary: #b2f042;
    --color-primary-light: #c5f56c;
    --color-accent: #b286fc;
    --border-radius-sm: 2px;
    --border-radius-md: 4px;
    --border-radius-lg: 6px;
    font-family: Inter, sans-serif;
    font-feature-settings:
      'liga' 1,
      'calt' 1; /* fix for Chrome */
  }

  @supports (font-variation-settings: normal) {
    :root {
      font-family: InterVariable, sans-serif;
    }
  }

  html {
    font-family: system-ui, sans-serif;
    background-size: 224px;
    scroll-behavior: smooth;
    scroll-padding-top: 1rem; /* Adjust this value based on header height */
  }

  body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  main {
    flex: 1;
  }

  /* Skip link styles */
  .skip-to-content {
    position: absolute;
    top: -40px;
    left: 0;
    background-color: #000000;
    color: #ffffff;
    padding: 8px 16px;
    z-index: 100;
    transition: top 0.2s ease-in-out;
    font-size: 14px;
    text-decoration: none;
  }

  .skip-to-content:focus {
    top: 0;
  }
</style>
